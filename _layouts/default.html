<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} - {{ site.title }}</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="alternate" type="application/rss+xml" title="{{ site.title }} - Comics Feed" href="{{ '/feed.xml' | absolute_url }}">
    <link rel="icon" type="image/png" href="/assets/images/favicon.png">
</head>
<body>
    <header>
        <div class="header-container">
            <p class="tagline">{{ site.tagline }}</p>
            <nav>
                <ul>
                    <li class="logo-nav-item">
                        <a href="/" class="logo-link">
                            <img src="/assets/images/logo.png" alt="{{ site.title }}">
                        </a>
                    </li>
                    <li><a href="/" data-label="Start Here"><span>Home</span></a></li>
                    <li><a href="/about" data-label="The Characters"><span>About</span></a></li>
                    <li><a href="/archive" data-label="All Strips"><span>Archive</span></a></li>
                    <li><a href="/blog" data-label="Dispatches"><span>Blog</span></a></li>
                    <li><a href="{{ site.social.store }}" data-label="Get the Book"><span>Books &amp; Merch!</span></a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        {{ content }}
    </main>

    <footer>
        <div class="footer-container">
            <!-- Logo placeholder - replace with actual Collarmark logo when ready -->
            <div class="footer-logo">
                <!-- Uncomment when you have the logo:
                <img src="/assets/images/collarmark-logo.png" alt="Collarmark Productions">
                -->
                <div class="footer-logo-placeholder">Collarmark</div>
            </div>
            
            <div class="footer-divider"></div>
            
            <p>&copy; 1999-{{ 'now' | date: "%Y" }} <a href="{{ site.author.url }}">{{ site.author.name }}</a> and Collarmark Productions.</p>
            
            <div class="footer-social">
                <a href="https://ko-fi.com/digitalcatholic" target="_blank" rel="noopener">â˜• Support on Ko-fi</a>
                <span class="footer-dot">â€¢</span>
                <a href="https://x.com/joecatholicart" target="_blank" rel="noopener">ğŸ¦ Follow on X</a>
                <span class="footer-dot">â€¢</span>
                <a href="https://youtube.com/@joecatholicdraws" target="_blank" rel="noopener">ğŸ¨ YouTube</a>
            </div>
            
            <p class="footer-links">
                <a href="/feed.xml">ğŸ“¡ RSS Feed</a> | 
                <a href="/about">About</a> | 
                <a href="/archive">Archive</a> |
                <a href="/privacy">Privacy Policy</a>
            </p>
        </div>
    </footer>

    <script>
    // â”€â”€ Bookmark System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    (function() {
        const BOOKMARK_KEY = 'jc_bookmark';
        const CONSENT_KEY  = 'jc_cookie_consent';

        function canBookmark() {
            try {
                const raw = localStorage.getItem(CONSENT_KEY);
                if (!raw) return false;
                const consent = JSON.parse(raw);
                return consent.functional !== false;
            } catch(e) { return false; }
        }

        function getBookmark() {
            try {
                const raw = localStorage.getItem(BOOKMARK_KEY);
                return raw ? JSON.parse(raw) : null;
            } catch(e) { return null; }
        }

        window.toggleBookmark = function(btn) {
            if (!canBookmark()) {
                if (window.showCookieBanner) showCookieBanner();
                return;
            }

            const url    = btn.dataset.url;
            const title  = btn.dataset.title;
            const number = btn.dataset.number;
            const existing = getBookmark();

            if (existing && existing.url === url) {
                try { localStorage.removeItem(BOOKMARK_KEY); } catch(e) {}
                updateBtn(btn, false);
            } else {
                try {
                    localStorage.setItem(BOOKMARK_KEY, JSON.stringify({
                        url, title, number,
                        savedAt: new Date().toISOString()
                    }));
                } catch(e) {}
                updateBtn(btn, true);
            }
        };

        function updateBtn(btn, isBookmarked) {
            const icon  = btn.querySelector('.bookmark-icon');
            const label = btn.querySelector('.bookmark-label');
            if (isBookmarked) {
                btn.classList.add('bookmarked');
                if (icon)  icon.textContent  = 'ğŸ”–';
                if (label) label.textContent = 'Bookmarked!';
            } else {
                btn.classList.remove('bookmarked');
                if (icon)  icon.textContent  = 'ğŸ”–';
                if (label) label.textContent = 'Bookmark';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const btn = document.getElementById('bookmark-btn');
            if (!btn) return;
            const bookmark = getBookmark();
            if (bookmark && bookmark.url === btn.dataset.url) {
                updateBtn(btn, true);
            }
        });
    })();
    </script>

    {% include cookie-consent.html %}

</body>
</html>
